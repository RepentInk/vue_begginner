<!DOCTYPE html>
  <head>
     <title>Vue For Beginners</title>
     <link rel="stylesheet" href="./css/style.css">

     <!-- Add Vue js -->
     <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

   </head>
  <body>

   <div id="wrapper">

       <!-- Page Header -->
      <div class="header-section">
         <header>
            <nav>
               <a href="#" class="logo"><img src="images/logo.png" alt="SDB 2023"></a>
		         <ul v-for="(item, index) in headerItems">
			         <li><a :href="item.link">{{ item.name }}</a></li>
		         </ul>
	         </nav>
         </header>
      </div>








        <!-- Page Section Form -->
       <div class="form-section">
              <h2>{{formTitle}}</h2>
               <form @submit.prevent = "saveData" class="my-form">
                  <div class="input-form">
                     <div>
                        <input type="text" required v-model="registration.first_name" id="fname" name="fname"  placeholder="First Name">
                        <input type="tel" required v-model="registration.phone_number" id="phone" name="phone"  placeholder="+233 55 753 2439">
                        <input type="date" required v-model="registration.date_of_birth" id="date" name="date"  placeholder="Date of Birth">
                     </div>
                     <div>
                        <input type="text" required v-model="registration.last_name" id="lname" name="lname" placeholder="Last Name">
                        <input type="email" required v-model="registration.email" id="email" name="email" placeholder="Your Email">
                        <input type="text" required v-model="registration.location" id="location" name="location" placeholder="Location">
                     </div>
                  </div>
                  <div class="bio-input">
                     <textarea name="comment" v-model="registration.biography" id="" cols="40" rows="5"></textarea>
                  </div>

                  <div class="input-box">
                     <h3>First Name: {{ registration.first_name }}</h3>
                     <h3>Last Name: {{ registration.last_name }}</h3>
                     <h3>Phone Number: {{ registration.phone_number }}</h3>
                     <h3>Email Address: {{ registration.email }}</h3>
                     <h3>Date of Birth: {{ registration.date_of_birth }}</h3>
                     <h3>Location: {{ registration.location }}</h3>
                     <h3>Biography: {{ registration.biography }}</h3>
                     
                  </div>
      
                  <div class="button-class">
                     <input @click.prevent="clearField()" type="button" class="btn" value="Clear">
                     <input type="submit" class="btn" :value="submitData">
                  </div>
                 </form>
       </div>
      








       <!-- Page Section Table -->
       <div class="table-section">
          <h2>LIST OF ALL APPLICANTS</h2>
          <Card class="card">
            <table>
               <thead>
                  <tr>
                     <th>id</th>
                     <th> First Name </th>
                     <th>Second Name</th>
                     <th>Phone Number</th>
                     <th>Email</th>
                     <th>Date of Birth</th>
                     <th>Location</th>
                     <th>Biography</th>
                     <th>Action</th>
                  </tr>
               </thead>

               <tbody>
                  <tr v-for="(student, index) in allStudents" :key="index">
                     <th>{{ student.id }}</th>
                     <th>{{ student.first_name }} </th>
                     <th>{{ student.last_name }}</th>
                     <th>{{ student.phone_number }}</th>
                     <th>{{ student.email }}</th>
                     <th>{{ student.date_of_birth }}</th>
                     <th>{{ student.location }}</th>
                     <th>{{ student.biography }}</th>
                     <td style="text-align: center;">
                        <span @click.prevent = "editData(student)" class="editButton">Edit</span>
                        <span class="deleteButton">delete</span>
                     </td>
                  </tr>
               </tbody>
               
            </table>
          </Card>
       </div>







       <!-- Body Section Footer -->
       <div class="footer-section">
          <div class="footer-links">
            <div class="social-icons">
               <ul>
                  <a href="https://www.facebook.com/maximnyansa/" target="_blank"></a>
                  <a href="https://twitter.com/MaximNyansa" target="_blank"></a>
                  <a href="https://www.linkedin.com/company/maxim-nyansa-it-solutions/" target="_blank"></a>
               </ul>
            </div>
            <div class="products">
               <h4>Maxim Products</h4>
               <ul>
                  <a href="https://web.trinitysoftwarecenter.com/" target="_blank">Trinity Software Center</a>
                  <a href="https://skuuni.com/" target="_blank">Skuuni</a>
                  <a href="https://library.maximnyansa.com" target="_blank">Maxim Digital Library</a>
               </ul>
            </div>
          </div>
       </div>


   </div>
   
   <!-- Script tag outside the wrapper -->
   <script> 
        const { createApp } = Vue;

        createApp({
         data() {
            return {
            placeFName: "First Name",
            updateData: false,
               headerItems: [
                  {
                     link: "/index.html",
                     name: "Home"
                  },
                  {
                     link: "/contact.html",
                     name: "Contact"
                  },
                  {
                     link: "/about.html",
                     name: "About"
                  },
                  {
                     link: "login",
                     name: "Login"
                  },
                  {
                     link: "product",
                     name: "Product"
                  },
                  {
                     link: "library",
                     name: "Library"
                  }
               ],

               registration: {
                  id: "",
                  first_name: "",
                  last_name: "",
                  phone_number: "",
                  email: "",
                  date_of_birth: "",
                  location: "",
                  biography: ""
               },

               listOfStudents: [],
               allStudents: []
            }
         },

         computed: {
              formTitle() {
               return this.updateData ? "UPDATE STUDENT RECORD" : "ADD NEW STUDENT RECORD";
              },

              submitData() {
               return this.updateData ? "Edit Data" : "Save Data";
              }
         },

         created() {
               this.fetchData();
         },
         methods: {
            saveData() {

               let oldStudent = localStorage.getItem("students");
               let parseOldData = JSON.parse(oldStudent);

               let student = {
                  id: parseOldData ? parseOldData.length + 1 : 1,
                  first_name: this.registration.first_name,
                  last_name: this.registration.last_name,
                  phone_number: this.registration.phone_number,
                  email: this.registration.email,
                  date_of_birth: this.registration.date_of_birth,
                  location: this.registration.location,
                  biography: this.registration.biography
               };

               this.listOfStudents = parseOldData ? [student, ...parseOldData] : [student];

               localStorage.setItem("students", JSON.stringify(this.listOfStudents));

               let students = localStorage.getItem("students")

               this.allStudents = JSON.parse(students);
                 
               this.clearField();

            },

            fetchData() {
               let students = localStorage.getItem("students");
               this.allStudents = JSON.parse(students);
            },

            clearField() {
               Object.keys(this.registration).forEach(key => {
                  this.registration[key] = "";
               });

                this.updateData = false;
            },

            editData(student) {
                console.log("Hello");
                Object.keys(this.registration).forEach(key => {
                  this.registration[key] = student[key]
                });
                this.updateData = true;
                
            }
         }
        }).mount("#wrapper");
   </script>
  </body>
</html>
